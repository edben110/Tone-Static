{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/edben/OneDrive/Desktop/codigos/js/tone-static/lib/jamendo.ts"],"sourcesContent":["const JAMENDO_CLIENT_ID = \"036f0b37\";\r\n\r\ninterface JamendoTrack {\r\n  id: number;\r\n  name: string;\r\n  artist_name: string;\r\n  audio?: string;\r\n  audiodownload?: string;\r\n}\r\n\r\ninterface JamendoResponse {\r\n  results: JamendoTrack[];\r\n}\r\n\r\nexport interface Track {\r\n  id: string;\r\n  name: string;\r\n  artist_name: string;\r\n  audio: string;\r\n}\r\n\r\nexport async function searchTracks(query: string): Promise<Track[]> {\r\n  try {\r\n    const res = await fetch(\r\n      `https://api.jamendo.com/v3.0/tracks/?client_id=${JAMENDO_CLIENT_ID}&format=json&limit=10&search=${query}`\r\n    );\r\n    if (!res.ok) throw new Error(\"Error al obtener canciones\");\r\n\r\n    const data: JamendoResponse = await res.json();\r\n\r\n    return (data.results || []).map((track) => ({\r\n      id: track.id.toString(),\r\n      name: track.name,\r\n      artist_name: track.artist_name,\r\n      audio: track.audio || track.audiodownload || ''\r\n    }));\r\n  } catch (error) {\r\n    console.error(\"Error en la búsqueda:\", error);\r\n    return [];\r\n  }\r\n}\r\n\r\n\r\n"],"names":[],"mappings":";;;;AAAA,MAAM,oBAAoB;AAqBnB,eAAe,aAAa,KAAa;IAC9C,IAAI;QACF,MAAM,MAAM,MAAM,MAChB,CAAC,+CAA+C,EAAE,kBAAkB,6BAA6B,EAAE,OAAO;QAE5G,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;QAE7B,MAAM,OAAwB,MAAM,IAAI,IAAI;QAE5C,OAAO,CAAC,KAAK,OAAO,IAAI,EAAE,EAAE,GAAG,CAAC,CAAC,QAAU,CAAC;gBAC1C,IAAI,MAAM,EAAE,CAAC,QAAQ;gBACrB,MAAM,MAAM,IAAI;gBAChB,aAAa,MAAM,WAAW;gBAC9B,OAAO,MAAM,KAAK,IAAI,MAAM,aAAa,IAAI;YAC/C,CAAC;IACH,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,EAAE;IACX;AACF","debugId":null}},
    {"offset": {"line": 29, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/edben/OneDrive/Desktop/codigos/js/tone-static/lib/DoubleLinkedList.ts"],"sourcesContent":["// ================= Node =================\r\nexport class Node<T> {\r\n  value: T;\r\n  next: Node<T> | null;\r\n  prev: Node<T> | null;\r\n\r\n  constructor(value: T) {\r\n    this.value = value;\r\n    this.next = null;\r\n    this.prev = null;\r\n  }\r\n}\r\n\r\n// ================= Double Linked List =================\r\nexport class DoubleLinkedList<T> {\r\n  head: Node<T> | null;\r\n  tail: Node<T> | null;\r\n  length: number;\r\n\r\n  constructor() {\r\n    this.head = null;\r\n    this.tail = null;\r\n    this.length = 0;\r\n  }\r\n\r\n  // Añadir al final\r\n  append(value: T): Node<T> {\r\n    const newNode = new Node(value);\r\n\r\n    if (!this.tail) {\r\n      this.head = newNode;\r\n      this.tail = newNode;\r\n    } else {\r\n      this.tail.next = newNode;\r\n      newNode.prev = this.tail;\r\n      this.tail = newNode;\r\n    }\r\n\r\n    this.length++;\r\n    return newNode;\r\n  }\r\n\r\n  // Añadir al inicio\r\n  prepend(value: T): Node<T> {\r\n    const newNode = new Node(value);\r\n\r\n    if (!this.head) {\r\n      this.head = newNode;\r\n      this.tail = newNode;\r\n    } else {\r\n      newNode.next = this.head;\r\n      this.head.prev = newNode;\r\n      this.head = newNode;\r\n    }\r\n\r\n    this.length++;\r\n    return newNode;\r\n  }\r\n\r\n  // Obtener nodo en índice (seguro)\r\n  getAt(index: number): Node<T> | null {\r\n    if (index < 0 || index >= this.length) return null;\r\n\r\n    let current: Node<T> | null;\r\n    let i: number;\r\n\r\n    if (index < this.length / 2) {\r\n      current = this.head;\r\n      i = 0;\r\n      while (i < index && current) {\r\n        current = current.next;\r\n        i++;\r\n      }\r\n    } else {\r\n      current = this.tail;\r\n      i = this.length - 1;\r\n      while (i > index && current) {\r\n        current = current.prev;\r\n        i--;\r\n      }\r\n    }\r\n\r\n    return current;\r\n  }\r\n\r\n  // Eliminar nodo por referencia\r\n  removeNode(node: Node<T>): void {\r\n    if (!node) return;\r\n\r\n    if (node.prev) node.prev.next = node.next;\r\n    else this.head = node.next;\r\n\r\n    if (node.next) node.next.prev = node.prev;\r\n    else this.tail = node.prev;\r\n\r\n    this.length--;\r\n  }\r\n\r\n  // Insertar en posición\r\n  insertAt(index: number, value: T): void {\r\n    if (index < 0 || index > this.length) return;\r\n    if (index === 0) {\r\n      this.prepend(value);\r\n      return;\r\n    }\r\n    if (index === this.length) {\r\n      this.append(value);\r\n      return;\r\n    }\r\n\r\n    const newNode = new Node(value);\r\n    const prevNode = this.getAt(index - 1);\r\n    const nextNode = prevNode?.next;\r\n\r\n    if (prevNode) {\r\n      prevNode.next = newNode;\r\n      newNode.prev = prevNode;\r\n    }\r\n\r\n    if (nextNode) {\r\n      newNode.next = nextNode;\r\n      nextNode.prev = newNode;\r\n    }\r\n\r\n    this.length++;\r\n  }\r\n\r\n  // Eliminar en posición\r\n  removeAt(index: number): T | null {\r\n    const nodeToRemove = this.getAt(index);\r\n    if (!nodeToRemove) return null;\r\n    this.removeNode(nodeToRemove);\r\n    return nodeToRemove.value;\r\n  }\r\n\r\n  // Convertir lista a array\r\n  toArray(): T[] {\r\n    const arr: T[] = [];\r\n    let current = this.head;\r\n\r\n    while (current) {\r\n      arr.push(current.value);\r\n      current = current.next;\r\n    }\r\n\r\n    return arr;\r\n  }\r\n\r\n  // Vaciar lista\r\n  clear(): void {\r\n    this.head = null;\r\n    this.tail = null;\r\n    this.length = 0;\r\n  }\r\n\r\n  // Mover nodo de una posición a otra\r\n  move(fromIndex: number, toIndex: number): void {\r\n    if (fromIndex < 0 || fromIndex >= this.length || toIndex < 0 || toIndex >= this.length) return;\r\n    if (fromIndex === toIndex) return;\r\n\r\n    const nodeToMove = this.getAt(fromIndex);\r\n    if (!nodeToMove) return;\r\n\r\n    // desconectar\r\n    if (nodeToMove.prev) nodeToMove.prev.next = nodeToMove.next;\r\n    else this.head = nodeToMove.next;\r\n\r\n    if (nodeToMove.next) nodeToMove.next.prev = nodeToMove.prev;\r\n    else this.tail = nodeToMove.prev;\r\n\r\n    // insertar en nueva posición\r\n    if (toIndex === 0) {\r\n      nodeToMove.next = this.head;\r\n      if (this.head) this.head.prev = nodeToMove;\r\n      this.head = nodeToMove;\r\n      nodeToMove.prev = null;\r\n    } else {\r\n      const prevNode = this.getAt(toIndex - 1);\r\n      if (!prevNode) return;\r\n\r\n      nodeToMove.next = prevNode.next;\r\n      nodeToMove.prev = prevNode;\r\n\r\n      if (prevNode.next) prevNode.next.prev = nodeToMove;\r\n      prevNode.next = nodeToMove;\r\n\r\n      if (prevNode === this.tail) this.tail = nodeToMove;\r\n    }\r\n  }\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 193, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/edben/OneDrive/Desktop/codigos/js/tone-static/components/Player.tsx"],"sourcesContent":["// js/tone-static/components/Player.tsx\r\n\"use client\";\r\n\r\nimport { useState, useRef, useEffect } from \"react\"; // <-- añado useEffect\r\nimport { searchTracks, Track } from \"../lib/jamendo\";\r\nimport { DoubleLinkedList, Node } from \"../lib/DoubleLinkedList\";\r\nimport { get, set } from \"idb-keyval\"; // <-- importo IndexedDB helper\r\nimport \"../app/globals.css\";\r\n\r\n// ================= Utils =================\r\nconst formatTime = (timeInSeconds: number): string => {\r\n  if (isNaN(timeInSeconds)) return \"0:00\";\r\n  const minutes = Math.floor(timeInSeconds / 60);\r\n  const seconds = Math.floor(timeInSeconds % 60);\r\n  return `${minutes}:${seconds < 10 ? \"0\" : \"\"}${seconds}`;\r\n};\r\n\r\n// Función para obtener duración de un track\r\nasync function getTrackDuration(url: string): Promise<number> {\r\n  return new Promise((resolve) => {\r\n    const audio = new Audio(url);\r\n    audio.addEventListener(\"loadedmetadata\", () => resolve(audio.duration));\r\n  });\r\n}\r\n\r\nexport default function Player() {\r\n  const [query, setQuery] = useState(\"\");\r\n  const [tracks, setTracks] = useState<(Track & { duration: number })[]>([]);\r\n  const [playlist, setPlaylist] = useState<(Track & { duration: number })[]>([]);\r\n  const [currentNode, setCurrentNode] = useState<Node<Track & { duration: number }> | null>(null);\r\n  const [loop, setLoop] = useState(false);\r\n  const [isPlaying, setIsPlaying] = useState(false);\r\n  const [progress, setProgress] = useState(0);\r\n  const [currentTime, setCurrentTime] = useState(0);\r\n  const [duration, setDuration] = useState(0);\r\n  const [loadingSearch, setLoadingSearch] = useState(false);\r\n\r\n  const audioRef = useRef<HTMLAudioElement | null>(null);\r\n  const playlistRef = useRef(new DoubleLinkedList<Track & { duration: number }>());\r\n  const [dragIndex, setDragIndex] = useState<number | null>(null);\r\n\r\n  // ================= Persistencia con IndexedDB =================\r\n  // Cargar playlist al iniciar\r\n  useEffect(() => {\r\n    (async () => {\r\n      const savedPlaylist = await get<(Track & { duration: number })[]>(\"playlist\");\r\n      if (savedPlaylist && savedPlaylist.length > 0) {\r\n        savedPlaylist.forEach((track) => playlistRef.current.append(track));\r\n        setPlaylist(savedPlaylist);\r\n      }\r\n    })();\r\n  }, []);\r\n\r\n  // Guardar playlist cada vez que cambie\r\n  useEffect(() => {\r\n    if (playlist.length > 0) {\r\n      set(\"playlist\", playlist).catch(console.error);\r\n    } else {\r\n      set(\"playlist\", []); // limpiar si está vacía\r\n    }\r\n  }, [playlist]);\r\n\r\n  // ================= Funciones =================\r\n  async function handleSearch(e: React.FormEvent) {\r\n    e.preventDefault();\r\n    setLoadingSearch(true);\r\n    const results = await searchTracks(query);\r\n\r\n    const resultsWithDuration = await Promise.all(\r\n      results.map(async (track) => {\r\n        const duration = track.audio ? await getTrackDuration(track.audio) : 0;\r\n        return { ...track, duration };\r\n      })\r\n    );\r\n\r\n    setTracks(resultsWithDuration);\r\n    setLoadingSearch(false);\r\n  }\r\n\r\n  function syncPlaylist() {\r\n    setPlaylist(playlistRef.current.toArray());\r\n  }\r\n\r\n  function addToPlaylist(track: Track & { duration: number }, autoPlay = false) {\r\n    let exists = false;\r\n    let node = playlistRef.current.head;\r\n    while (node) {\r\n      if (node.value.id === track.id) {\r\n        exists = true;\r\n        break;\r\n      }\r\n      node = node.next;\r\n    }\r\n    if (exists) return;\r\n\r\n    const newNode = playlistRef.current.append(track);\r\n    syncPlaylist();\r\n\r\n    if (!currentNode || autoPlay) playNode(newNode);\r\n    return newNode;\r\n  }\r\n\r\n  function playNode(node: Node<Track & { duration: number }>) {\r\n    if (!node) return;\r\n    setCurrentNode(node);\r\n    if (!audioRef.current) audioRef.current = new Audio();\r\n    const audioEl = audioRef.current;\r\n\r\n    audioEl.src = node.value.audio;\r\n    audioEl.loop = loop;\r\n    audioEl.play().then(() => setIsPlaying(true)).catch(console.error);\r\n\r\n    audioEl.onended = () => {\r\n      if (loop) playNode(node);\r\n      else if (node.next) playNode(node.next);\r\n      else setIsPlaying(false);\r\n    };\r\n  }\r\n\r\n  function togglePlayPause() {\r\n    if (!audioRef.current || !currentNode) return;\r\n    if (isPlaying) {\r\n      audioRef.current.pause();\r\n      setIsPlaying(false);\r\n    } else {\r\n      audioRef.current.play();\r\n      setIsPlaying(true);\r\n    }\r\n  }\r\n\r\n  function stopSong() {\r\n    if (audioRef.current) {\r\n      audioRef.current.pause();\r\n      audioRef.current.currentTime = 0;\r\n      setIsPlaying(false);\r\n      setProgress(0);\r\n      setCurrentTime(0);\r\n    }\r\n  }\r\n\r\n  function playPrev() {\r\n    if (currentNode?.prev) playNode(currentNode.prev);\r\n  }\r\n\r\n  function playNext() {\r\n    if (currentNode?.next) playNode(currentNode.next);\r\n  }\r\n\r\n  function updateProgress() {\r\n    if (audioRef.current) {\r\n      setProgress((audioRef.current.currentTime / audioRef.current.duration) * 100);\r\n      setCurrentTime(audioRef.current.currentTime);\r\n      setDuration(audioRef.current.duration);\r\n    }\r\n  }\r\n\r\n  function seek(e: React.MouseEvent<HTMLDivElement>) {\r\n    if (!audioRef.current) return;\r\n    const rect = e.currentTarget.getBoundingClientRect();\r\n    const percent = (e.clientX - rect.left) / rect.width;\r\n    audioRef.current.currentTime = percent * audioRef.current.duration;\r\n  }\r\n\r\n  function handleFileUpload(e: React.ChangeEvent<HTMLInputElement>) {\r\n    const file = e.target.files?.[0];\r\n    if (file) {\r\n      const url = URL.createObjectURL(file);\r\n      getTrackDuration(url).then((duration) => {\r\n        const localTrack: Track & { duration: number } = {\r\n          id: file.name,\r\n          name: file.name,\r\n          artist_name: \"Local\",\r\n          audio: url,\r\n          duration,\r\n        };\r\n        addToPlaylist(localTrack, true);\r\n      });\r\n    }\r\n  }\r\n\r\n  function removeFromPlaylist(id: string) {\r\n    let node = playlistRef.current.head;\r\n    while (node) {\r\n      if (node.value.id === id) {\r\n        if (currentNode?.value.id === id) stopSong();\r\n        playlistRef.current.removeNode(node);\r\n        syncPlaylist();\r\n        break;\r\n      }\r\n      node = node.next;\r\n    }\r\n  }\r\n\r\n  // ================= Drag & Drop =================\r\n  function handleDragStart(e: React.DragEvent<HTMLLIElement>, index: number) {\r\n    setDragIndex(index);\r\n    e.dataTransfer.setData(\"text/plain\", index.toString());\r\n  }\r\n\r\n  function handleDragOver(e: React.DragEvent<HTMLLIElement>) {\r\n    e.preventDefault();\r\n  }\r\n\r\n  function handleDrop(e: React.DragEvent<HTMLLIElement>, dropIndex: number) {\r\n    e.preventDefault();\r\n    const data = e.dataTransfer.getData(\"text/plain\");\r\n    const fromIndex = data ? parseInt(data, 10) : (dragIndex ?? -1);\r\n\r\n    if (fromIndex < 0 || fromIndex === dropIndex || isNaN(fromIndex)) {\r\n      setDragIndex(null);\r\n      return;\r\n    }\r\n\r\n    playlistRef.current.move(fromIndex, dropIndex);\r\n    syncPlaylist();\r\n\r\n    const currentId = currentNode?.value.id;\r\n    if (currentId) {\r\n      let node = playlistRef.current.head;\r\n      while (node && node.value.id !== currentId) {\r\n        node = node.next;\r\n      }\r\n      setCurrentNode(node ?? null);\r\n    }\r\n\r\n    setDragIndex(null);\r\n  }\r\n\r\n  // ================= UI =================\r\n  return (\r\n    <div className=\"player-container\">\r\n      <h1>Tone Static</h1>\r\n\r\n      <form onSubmit={handleSearch} className=\"search-form\">\r\n        {loadingSearch && (\r\n          <div className=\"sound-spectrum\" aria-hidden=\"true\" style={{ marginRight: 8 }}>\r\n            {Array.from({ length: 12 }).map((_, i) => (\r\n              <span key={i} className=\"bar\"></span>\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Buscar en Jamendo...\"\r\n          value={query}\r\n          onChange={(e) => setQuery(e.target.value)}\r\n          className=\"w-full p-8 pr-100\"\r\n        />\r\n        <button type=\"submit\" disabled={loadingSearch}>\r\n          Buscar\r\n        </button>\r\n      </form>\r\n\r\n      <div className=\"lists-container\">\r\n        {/* Resultados */}\r\n        <div className=\"results\">\r\n          <h3>Resultados</h3>\r\n          <ul>\r\n            {tracks.map((track) => (\r\n              <li key={track.id}>\r\n                <span className=\"track-info\">\r\n                  <strong>{track.name}</strong> -- {track.artist_name}{\" \"}\r\n                  {track.duration && <span>({formatTime(track.duration)})</span>}\r\n                </span>\r\n                <div className=\"opt\">\r\n                  <button onClick={() => addToPlaylist(track, true)}>▶ Reproducir</button>\r\n                  <button onClick={() => addToPlaylist(track)}>+ Añadir</button>\r\n                </div>\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        </div>\r\n\r\n        {/* Playlist */}\r\n        <div className=\"playlist\">\r\n          <h3>Lista</h3>\r\n          <ul>\r\n            {playlist.length > 0 ? (\r\n              playlist.map((track, index) => {\r\n                const isCurrent = currentNode?.value.id === track.id;\r\n                return (\r\n                  <li\r\n                    key={track.id}\r\n                    className={isCurrent ? \"active\" : \"\"}\r\n                    draggable\r\n                    onDragStart={(e) => handleDragStart(e, index)}\r\n                    onDragOver={handleDragOver}\r\n                    onDrop={(e) => handleDrop(e, index)}\r\n                  >\r\n                    <span className=\"track-info\">\r\n                      {index + 1}. {track.name} -- {track.artist_name}{\" \"}\r\n                      {track.duration && <span>({formatTime(track.duration)})</span>}\r\n                    </span>\r\n\r\n                    <div className=\"button-group\">\r\n                      <button\r\n                        onClick={() => {\r\n                          let node = playlistRef.current.head;\r\n                          while (node && node.value.id !== track.id) node = node.next;\r\n                          if (node) playNode(node);\r\n                        }}\r\n                      >\r\n                        {isCurrent ? \"⏸ En reproducción\" : \"Reproducir\"}\r\n                      </button>\r\n                      <button onClick={() => removeFromPlaylist(track.id)}>Eliminar</button>\r\n                    </div>\r\n                  </li>\r\n                );\r\n              })\r\n            ) : (\r\n              <p>No hay canciones en la lista.</p>\r\n            )}\r\n          </ul>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Barra de reproducción */}\r\n      <div className=\"player-bar\">\r\n        <div className=\"player-content\">\r\n          <p>\r\n            {currentNode ? (\r\n              <>\r\n                <strong>{currentNode.value.name}</strong> -- {currentNode.value.artist_name}\r\n              </>\r\n            ) : (\r\n              \"Ninguna canción seleccionada\"\r\n            )}\r\n          </p>\r\n\r\n          <div className=\"progress-container\" onClick={seek}>\r\n            <div className=\"progress\" style={{ width: `${progress}%` }}></div>\r\n          </div>\r\n\r\n          <div className=\"time\">\r\n            <span>{formatTime(currentTime)}</span> / <span>{formatTime(duration)}</span>\r\n          </div>\r\n\r\n          <div className=\"controls\">\r\n            <div className=\"upload\">\r\n              <label className=\"upload-btn\">\r\n                Subir canción\r\n                <input\r\n                  type=\"file\"\r\n                  accept=\"audio/*\"\r\n                  onChange={handleFileUpload}\r\n                  style={{ display: \"none\" }}\r\n                />\r\n              </label>\r\n            </div>\r\n            <button onClick={playPrev} disabled={!currentNode?.prev}>⏮</button>\r\n            <button onClick={togglePlayPause} disabled={!currentNode}>\r\n              {isPlaying ? \"⏸\" : \"▶\"}\r\n            </button>\r\n            <button onClick={stopSong} disabled={!currentNode}>⏹</button>\r\n            <button onClick={playNext} disabled={!currentNode?.next}>⏭</button>\r\n            <button onClick={() => setLoop(!loop)}>{loop ? \"Loop ON\" : \"Loop OFF\"}</button>\r\n          </div>\r\n\r\n          <audio ref={audioRef} onTimeUpdate={updateProgress} style={{ display: \"none\" }} />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 836, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/edben/OneDrive/Desktop/codigos/js/tone-static/app/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport Player from \"../components/Player\";\r\n\r\nexport default function Home() {\r\n  return <Player />;\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAIe,SAAS;IACtB,qBAAO,sQAAC,wJAAM;;;;;AAChB","debugId":null}},
    {"offset": {"line": 856, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/edben/OneDrive/Desktop/codigos/js/tone-static/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxDevRuntime\n"],"names":["module","exports","require","vendored","ReactJsxDevRuntime"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,2IACRC,QAAQ,CAAC,YAAY,CAAEC,kBAAkB","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 861, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/edben/OneDrive/Desktop/codigos/js/tone-static/node_modules/idb-keyval/dist/index.js"],"sourcesContent":["function promisifyRequest(request) {\n    return new Promise((resolve, reject) => {\n        // @ts-ignore - file size hacks\n        request.oncomplete = request.onsuccess = () => resolve(request.result);\n        // @ts-ignore - file size hacks\n        request.onabort = request.onerror = () => reject(request.error);\n    });\n}\nfunction createStore(dbName, storeName) {\n    let dbp;\n    const getDB = () => {\n        if (dbp)\n            return dbp;\n        const request = indexedDB.open(dbName);\n        request.onupgradeneeded = () => request.result.createObjectStore(storeName);\n        dbp = promisifyRequest(request);\n        dbp.then((db) => {\n            // It seems like Safari sometimes likes to just close the connection.\n            // It's supposed to fire this event when that happens. Let's hope it does!\n            db.onclose = () => (dbp = undefined);\n        }, () => { });\n        return dbp;\n    };\n    return (txMode, callback) => getDB().then((db) => callback(db.transaction(storeName, txMode).objectStore(storeName)));\n}\nlet defaultGetStoreFunc;\nfunction defaultGetStore() {\n    if (!defaultGetStoreFunc) {\n        defaultGetStoreFunc = createStore('keyval-store', 'keyval');\n    }\n    return defaultGetStoreFunc;\n}\n/**\n * Get a value by its key.\n *\n * @param key\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction get(key, customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => promisifyRequest(store.get(key)));\n}\n/**\n * Set a value with a key.\n *\n * @param key\n * @param value\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction set(key, value, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        store.put(value, key);\n        return promisifyRequest(store.transaction);\n    });\n}\n/**\n * Set multiple values at once. This is faster than calling set() multiple times.\n * It's also atomic – if one of the pairs can't be added, none will be added.\n *\n * @param entries Array of entries, where each entry is an array of `[key, value]`.\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction setMany(entries, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        entries.forEach((entry) => store.put(entry[1], entry[0]));\n        return promisifyRequest(store.transaction);\n    });\n}\n/**\n * Get multiple values by their keys\n *\n * @param keys\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction getMany(keys, customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => Promise.all(keys.map((key) => promisifyRequest(store.get(key)))));\n}\n/**\n * Update a value. This lets you see the old value and update it as an atomic operation.\n *\n * @param key\n * @param updater A callback that takes the old value and returns a new value.\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction update(key, updater, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => \n    // Need to create the promise manually.\n    // If I try to chain promises, the transaction closes in browsers\n    // that use a promise polyfill (IE10/11).\n    new Promise((resolve, reject) => {\n        store.get(key).onsuccess = function () {\n            try {\n                store.put(updater(this.result), key);\n                resolve(promisifyRequest(store.transaction));\n            }\n            catch (err) {\n                reject(err);\n            }\n        };\n    }));\n}\n/**\n * Delete a particular key from the store.\n *\n * @param key\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction del(key, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        store.delete(key);\n        return promisifyRequest(store.transaction);\n    });\n}\n/**\n * Delete multiple keys at once.\n *\n * @param keys List of keys to delete.\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction delMany(keys, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        keys.forEach((key) => store.delete(key));\n        return promisifyRequest(store.transaction);\n    });\n}\n/**\n * Clear all values in the store.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction clear(customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        store.clear();\n        return promisifyRequest(store.transaction);\n    });\n}\nfunction eachCursor(store, callback) {\n    store.openCursor().onsuccess = function () {\n        if (!this.result)\n            return;\n        callback(this.result);\n        this.result.continue();\n    };\n    return promisifyRequest(store.transaction);\n}\n/**\n * Get all keys in the store.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction keys(customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => {\n        // Fast path for modern browsers\n        if (store.getAllKeys) {\n            return promisifyRequest(store.getAllKeys());\n        }\n        const items = [];\n        return eachCursor(store, (cursor) => items.push(cursor.key)).then(() => items);\n    });\n}\n/**\n * Get all values in the store.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction values(customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => {\n        // Fast path for modern browsers\n        if (store.getAll) {\n            return promisifyRequest(store.getAll());\n        }\n        const items = [];\n        return eachCursor(store, (cursor) => items.push(cursor.value)).then(() => items);\n    });\n}\n/**\n * Get all entries in the store. Each entry is an array of `[key, value]`.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction entries(customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => {\n        // Fast path for modern browsers\n        // (although, hopefully we'll get a simpler path some day)\n        if (store.getAll && store.getAllKeys) {\n            return Promise.all([\n                promisifyRequest(store.getAllKeys()),\n                promisifyRequest(store.getAll()),\n            ]).then(([keys, values]) => keys.map((key, i) => [key, values[i]]));\n        }\n        const items = [];\n        return customStore('readonly', (store) => eachCursor(store, (cursor) => items.push([cursor.key, cursor.value])).then(() => items));\n    });\n}\n\nexport { clear, createStore, del, delMany, entries, get, getMany, keys, promisifyRequest, set, setMany, update, values };\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}}]
}